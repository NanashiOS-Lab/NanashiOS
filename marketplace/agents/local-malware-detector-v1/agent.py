def run(input_data):
    """
    Local-Malware-Detector-v1 - NanashiOS
    Scan local de malware sans envoi de données
    """
    file_path = input_data.get("file_path", "")
    scan_mode = input_data.get("scan_mode", "quick")

    # Simulation simple (à remplacer par vrai scan YARA/ClamAV plus tard)
    if "virus" in file_path.lower() or "malware" in file_path.lower():
        is_malicious = True
        threat_score = 0.92
        details = "Malware détecté : signature YARA positive"
    else:
        is_malicious = False
        threat_score = 0.05
        details = "Aucune menace détectée"

    return {
        "is_malicious": is_malicious,
        "threat_score": threat_score,
        "details": details,
        "status": "success"
    }
